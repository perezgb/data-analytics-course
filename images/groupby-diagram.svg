<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 600">
  <!-- Background -->
  <rect width="1000" height="600" fill="#f8f9fa" rx="10" ry="10"/>
  
  <!-- Title -->
  <text x="450" y="40" font-family="Arial" font-size="24" text-anchor="middle" font-weight="bold">GroupBy: Split-Apply-Combine</text>
  
  <!-- Original DataFrame -->
  <rect x="50" y="80" width="180" height="260" fill="white" stroke="#ddd" stroke-width="2" rx="5" ry="5"/>
  <text x="140" y="70" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold">Original Data</text>
  
  <!-- Original DataFrame Headers -->
  <rect x="50" y="80" width="50" height="30" fill="#f8f8f8" stroke="#ddd" stroke-width="1"/>
  <rect x="100" y="80" width="50" height="30" fill="#e6f3ff" stroke="#aad" stroke-width="1"/>
  <rect x="150" y="80" width="40" height="30" fill="#e6f3ff" stroke="#aad" stroke-width="1"/>
  <rect x="190" y="80" width="40" height="30" fill="#e6f3ff" stroke="#aad" stroke-width="1"/>
  
  <!-- Original DataFrame Header Text -->
  <text x="75" y="100" font-family="monospace" font-size="12" text-anchor="middle" font-weight="bold"></text>
  <text x="125" y="100" font-family="monospace" font-size="12" text-anchor="middle" font-weight="bold">author</text>
  <text x="170" y="100" font-family="monospace" font-size="12" text-anchor="middle" font-weight="bold">files</text>
  <text x="210" y="100" font-family="monospace" font-size="12" text-anchor="middle" font-weight="bold">lines</text>
  
  <!-- Original DataFrame Index -->
  <rect x="50" y="110" width="50" height="35" fill="#fff0e6" stroke="#daa" stroke-width="1"/>
  <rect x="50" y="145" width="50" height="35" fill="#fff0e6" stroke="#daa" stroke-width="1"/>
  <rect x="50" y="180" width="50" height="35" fill="#fff0e6" stroke="#daa" stroke-width="1"/>
  <rect x="50" y="215" width="50" height="35" fill="#fff0e6" stroke="#daa" stroke-width="1"/>
  <rect x="50" y="250" width="50" height="35" fill="#fff0e6" stroke="#daa" stroke-width="1"/>
  <rect x="50" y="285" width="50" height="35" fill="#fff0e6" stroke="#daa" stroke-width="1"/>
  
  <!-- Original DataFrame Index Text -->
  <text x="75" y="130" font-family="monospace" font-size="12" text-anchor="middle" font-weight="bold">0</text>
  <text x="75" y="165" font-family="monospace" font-size="12" text-anchor="middle" font-weight="bold">1</text>
  <text x="75" y="200" font-family="monospace" font-size="12" text-anchor="middle" font-weight="bold">2</text>
  <text x="75" y="235" font-family="monospace" font-size="12" text-anchor="middle" font-weight="bold">3</text>
  <text x="75" y="270" font-family="monospace" font-size="12" text-anchor="middle" font-weight="bold">4</text>
  <text x="75" y="305" font-family="monospace" font-size="12" text-anchor="middle" font-weight="bold">5</text>
  
  <!-- Original DataFrame Data -->
  <!-- Row 0 -->
  <rect x="100" y="110" width="50" height="35" fill="#e6fff2" stroke="#ddd" stroke-width="1"/>
  <rect x="150" y="110" width="40" height="35" fill="white" stroke="#ddd" stroke-width="1"/>
  <rect x="190" y="110" width="40" height="35" fill="white" stroke="#ddd" stroke-width="1"/>
  
  <!-- Row 1 -->
  <rect x="100" y="145" width="50" height="35" fill="#fff0e6" stroke="#ddd" stroke-width="1"/>
  <rect x="150" y="145" width="40" height="35" fill="white" stroke="#ddd" stroke-width="1"/>
  <rect x="190" y="145" width="40" height="35" fill="white" stroke="#ddd" stroke-width="1"/>
  
  <!-- Row 2 -->
  <rect x="100" y="180" width="50" height="35" fill="#e6fff2" stroke="#ddd" stroke-width="1"/>
  <rect x="150" y="180" width="40" height="35" fill="white" stroke="#ddd" stroke-width="1"/>
  <rect x="190" y="180" width="40" height="35" fill="white" stroke="#ddd" stroke-width="1"/>
  
  <!-- Row 3 -->
  <rect x="100" y="215" width="50" height="35" fill="#e1d4ff" stroke="#ddd" stroke-width="1"/>
  <rect x="150" y="215" width="40" height="35" fill="white" stroke="#ddd" stroke-width="1"/>
  <rect x="190" y="215" width="40" height="35" fill="white" stroke="#ddd" stroke-width="1"/>
  
  <!-- Row 4 -->
  <rect x="100" y="250" width="50" height="35" fill="#fff0e6" stroke="#ddd" stroke-width="1"/>
  <rect x="150" y="250" width="40" height="35" fill="white" stroke="#ddd" stroke-width="1"/>
  <rect x="190" y="250" width="40" height="35" fill="white" stroke="#ddd" stroke-width="1"/>
  
  <!-- Row 5 -->
  <rect x="100" y="285" width="50" height="35" fill="#e1d4ff" stroke="#ddd" stroke-width="1"/>
  <rect x="150" y="285" width="40" height="35" fill="white" stroke="#ddd" stroke-width="1"/>
  <rect x="190" y="285" width="40" height="35" fill="white" stroke="#ddd" stroke-width="1"/>
  
  <!-- Original DataFrame Data Text -->
  <text x="125" y="130" font-family="monospace" font-size="12" text-anchor="middle">Alice</text>
  <text x="170" y="130" font-family="monospace" font-size="12" text-anchor="middle">2</text>
  <text x="210" y="130" font-family="monospace" font-size="12" text-anchor="middle">15</text>
  
  <text x="125" y="165" font-family="monospace" font-size="12" text-anchor="middle">Bob</text>
  <text x="170" y="165" font-family="monospace" font-size="12" text-anchor="middle">5</text>
  <text x="210" y="165" font-family="monospace" font-size="12" text-anchor="middle">42</text>
  
  <text x="125" y="200" font-family="monospace" font-size="12" text-anchor="middle">Alice</text>
  <text x="170" y="200" font-family="monospace" font-size="12" text-anchor="middle">1</text>
  <text x="210" y="200" font-family="monospace" font-size="12" text-anchor="middle">7</text>
  
  <text x="125" y="235" font-family="monospace" font-size="12" text-anchor="middle">Julia</text>
  <text x="170" y="235" font-family="monospace" font-size="12" text-anchor="middle">3</text>
  <text x="210" y="235" font-family="monospace" font-size="12" text-anchor="middle">29</text>
  
  <text x="125" y="270" font-family="monospace" font-size="12" text-anchor="middle">Bob</text>
  <text x="170" y="270" font-family="monospace" font-size="12" text-anchor="middle">7</text>
  <text x="210" y="270" font-family="monospace" font-size="12" text-anchor="middle">120</text>
  
  <text x="125" y="305" font-family="monospace" font-size="12" text-anchor="middle">Julia</text>
  <text x="170" y="305" font-family="monospace" font-size="12" text-anchor="middle">4</text>
  <text x="210" y="305" font-family="monospace" font-size="12" text-anchor="middle">33</text>
  
  <!-- Split Section -->
  <rect x="280" y="80" width="180" height="260" fill="#f0ffff" stroke="#3498db" stroke-width="2" rx="5" ry="5"/>
  <text x="370" y="70" font-family="Arial" font-size="16" text-anchor="middle" fill="#3498db" font-weight="bold">SPLIT</text>
  
  <!-- Alice Group -->
  <rect x="305" y="100" width="130" height="70" fill="white" stroke="#ddd" stroke-width="1" rx="3" ry="3"/>
  <text x="370" y="120" font-family="Arial" font-size="12" text-anchor="middle" font-weight="bold">Alice Group</text>
  <rect x="315" y="125" width="110" height="20" fill="#e6fff2" stroke="#ddd" stroke-width="1"/>
  <rect x="315" y="145" width="110" height="20" fill="#e6fff2" stroke="#ddd" stroke-width="1"/>
  
  <!-- Bob Group -->
  <rect x="305" y="180" width="130" height="70" fill="white" stroke="#ddd" stroke-width="1" rx="3" ry="3"/>
  <text x="370" y="200" font-family="Arial" font-size="12" text-anchor="middle" font-weight="bold">Bob Group</text>
  <rect x="315" y="205" width="110" height="20" fill="#fff0e6" stroke="#ddd" stroke-width="1"/>
  <rect x="315" y="225" width="110" height="20" fill="#fff0e6" stroke="#ddd" stroke-width="1"/>
  
  <!-- Julia Group -->
  <rect x="305" y="260" width="130" height="70" fill="white" stroke="#ddd" stroke-width="1" rx="3" ry="3"/>
  <text x="370" y="280" font-family="Arial" font-size="12" text-anchor="middle" font-weight="bold">Julia Group</text>
  <rect x="315" y="285" width="110" height="20" fill="#e1d4ff" stroke="#ddd" stroke-width="1"/>
  <rect x="315" y="305" width="110" height="20" fill="#e1d4ff" stroke="#ddd" stroke-width="1"/>
  
  <!-- Apply Section -->
  <rect x="510" y="80" width="180" height="260" fill="#f9ebea" stroke="#e74c3c" stroke-width="2" rx="5" ry="5"/>
  <text x="600" y="70" font-family="Arial" font-size="16" text-anchor="middle" fill="#e74c3c" font-weight="bold">APPLY</text>
  
  <!-- Apply Functions -->
  <rect x="535" y="120" width="130" height="35" fill="white" stroke="#ddd" stroke-width="1" rx="3" ry="3"/>
  <text x="600" y="142" font-family="Arial" font-size="12" text-anchor="middle" font-style="italic">sum()</text>
  
  <rect x="535" y="165" width="130" height="35" fill="white" stroke="#ddd" stroke-width="1" rx="3" ry="3"/>
  <text x="600" y="187" font-family="Arial" font-size="12" text-anchor="middle" font-style="italic">mean()</text>
  
  <rect x="535" y="210" width="130" height="35" fill="white" stroke="#ddd" stroke-width="1" rx="3" ry="3"/>
  <text x="600" y="232" font-family="Arial" font-size="12" text-anchor="middle" font-style="italic">count()</text>
  
  <rect x="535" y="255" width="130" height="35" fill="white" stroke="#ddd" stroke-width="1" rx="3" ry="3"/>
  <text x="600" y="277" font-family="Arial" font-size="12" text-anchor="middle" font-style="italic">custom agg</text>
  
  <!-- Combine Section - Result DataFrame -->
  <rect x="740" y="80" width="210" height="260" fill="#e8f8f5" stroke="#2ecc71" stroke-width="2" rx="5" ry="5"/>
  <text x="850" y="70" font-family="Arial" font-size="16" text-anchor="middle" fill="#2ecc71" font-weight="bold">COMBINE</text>
  
  <!-- Result DataFrame Headers -->
  <rect x="755" y="110" width="50" height="35" fill="#f8f8f8" stroke="#ddd" stroke-width="1"/>
  <rect x="805" y="110" width="65" height="35" fill="#e6f3ff" stroke="#aad" stroke-width="1"/>
  <rect x="870" y="110" width="65" height="35" fill="#e6f3ff" stroke="#aad" stroke-width="1"/>
  
  <!-- Result DataFrame Header Text -->
  <text x="780" y="132" font-family="monospace" font-size="11" text-anchor="middle" font-weight="bold">author</text>
  <text x="838" y="132" font-family="monospace" font-size="11" text-anchor="middle" font-weight="bold">files_sum</text>
  <text x="903" y="132" font-family="monospace" font-size="11" text-anchor="middle" font-weight="bold">lines_sum</text>
  
  <!-- Result DataFrame Row 0 -->
  <rect x="755" y="145" width="50" height="45" fill="#e6fff2" stroke="#ddd" stroke-width="1"/>
  <rect x="805" y="145" width="65" height="45" fill="white" stroke="#ddd" stroke-width="1"/>
  <rect x="870" y="145" width="65" height="45" fill="white" stroke="#ddd" stroke-width="1"/>
  
  <!-- Result DataFrame Row 1 -->
  <rect x="755" y="190" width="50" height="45" fill="#fff0e6" stroke="#ddd" stroke-width="1"/>
  <rect x="805" y="190" width="65" height="45" fill="white" stroke="#ddd" stroke-width="1"/>
  <rect x="870" y="190" width="65" height="45" fill="white" stroke="#ddd" stroke-width="1"/>
  
  <!-- Result DataFrame Row 2 -->
  <rect x="755" y="235" width="50" height="45" fill="#e1d4ff" stroke="#ddd" stroke-width="1"/>
  <rect x="805" y="235" width="65" height="45" fill="white" stroke="#ddd" stroke-width="1"/>
  <rect x="870" y="235" width="65" height="45" fill="white" stroke="#ddd" stroke-width="1"/>
  
  <!-- Result DataFrame Data Text -->
  <text x="780" y="175" font-family="monospace" font-size="12" text-anchor="middle">Alice</text>
  <text x="832" y="175" font-family="monospace" font-size="12" text-anchor="middle">3</text>
  <text x="897" y="175" font-family="monospace" font-size="12" text-anchor="middle">22</text>
  
  <text x="780" y="220" font-family="monospace" font-size="12" text-anchor="middle">Bob</text>
  <text x="832" y="220" font-family="monospace" font-size="12" text-anchor="middle">12</text>
  <text x="897" y="220" font-family="monospace" font-size="12" text-anchor="middle">162</text>
  
  <text x="780" y="265" font-family="monospace" font-size="12" text-anchor="middle">Julia</text>
  <text x="832" y="265" font-family="monospace" font-size="12" text-anchor="middle">7</text>
  <text x="897" y="265" font-family="monospace" font-size="12" text-anchor="middle">62</text>
  
  <!-- Arrows between sections -->
  <path d="M230 210 L280 210" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M460 210 L510 210" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M690 210 L740 210" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Code Example -->
  <rect x="250" y="380" width="220" height="110" fill="#f5f5f5" stroke="#777" stroke-width="1" rx="5" ry="5"/>
  <text x="360" y="400" font-family="monospace" font-size="12" text-anchor="middle" fill="#555">df.groupby('author')</text>
  <text x="330" y="420" font-family="monospace" font-size="12" text-anchor="middle" fill="#555">.agg({</text>
  <text x="390" y="440" font-family="monospace" font-size="12" text-anchor="middle" fill="#555">    'files': 'sum',</text>
  <text x="390" y="460" font-family="monospace" font-size="12" text-anchor="middle" fill="#555">    'lines': 'sum'</text>
  <text x="320" y="480" font-family="monospace" font-size="12" text-anchor="middle" fill="#555">})</text>
  
  <!-- Legend - Moved beside code box -->
  <rect x="500" y="380" width="150" height="110" fill="#f8f9fa" stroke="#ddd" stroke-width="1" rx="5" ry="5"/>
  <text x="575" y="400" font-family="Arial" font-size="14" text-anchor="middle" font-weight="bold">Legend</text>
  
  <rect x="520" y="405" width="20" height="20" fill="#e6fff2" stroke="#ddd" stroke-width="1"/>
  <text x="550" y="420" font-family="Arial" font-size="12" text-anchor="start">Alice</text>
  
  <rect x="520" y="435" width="20" height="20" fill="#fff0e6" stroke="#ddd" stroke-width="1"/>
  <text x="550" y="450" font-family="Arial" font-size="12" text-anchor="start">Bob</text>
  
  <rect x="520" y="465" width="20" height="20" fill="#e1d4ff" stroke="#ddd" stroke-width="1"/>
  <text x="550" y="480" font-family="Arial" font-size="12" text-anchor="start">Julia</text>
  
  <!-- Arrowhead marker -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#555"/>
    </marker>
  </defs>
</svg>